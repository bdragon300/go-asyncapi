import (
	"bytes"

	wsclient "github.com/gobwas/ws" {{/* Import alias to avoid conflict with generated package name */}}
	"github.com/gobwas/ws/wsutil"
)

func NewEnvelopeOut(buf []byte) *EnvelopeOut {
	return &EnvelopeOut{Buffer: bytes.NewBuffer(buf)}
}

type EnvelopeOut struct {
	*bytes.Buffer
	opCode      wsclient.OpCode
	headers     {{goPkgRun}}Headers
	contentType string
}

func (e *EnvelopeOut) ResetPayload() {
	e.Buffer.Reset()
}

func (e *EnvelopeOut) SetHeaders(headers {{goPkgRun}}Headers) {
	e.headers = headers
}

func (e *EnvelopeOut) SetContentType(contentType string) {
	e.contentType = contentType
}

func (e *EnvelopeOut) SetBindings(_ {{goPkgUtil "ws"}}MessageBindings) {}

func (e *EnvelopeOut) SetOpCode(opCode byte) {
	e.opCode = wsclient.OpCode(opCode)
}

func (e *EnvelopeOut) OpCode() wsclient.OpCode {
	return e.opCode
}

func NewEnvelopeIn(msg wsutil.Message) *EnvelopeIn {
	return &EnvelopeIn{Message: msg, reader: bytes.NewReader(msg.Payload)}
}

type EnvelopeIn struct {
	wsutil.Message
	reader *bytes.Reader
}

func (e *EnvelopeIn) Read(p []byte) (n int, err error) {
	return e.reader.Read(p)
}

func (e *EnvelopeIn) Headers() {{goPkgRun}}Headers {
	return nil
}
