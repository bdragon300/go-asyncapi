{{if .ProtocolVersion}}
const {{.GolangName}}ProtocolVersion = "{{.ProtocolVersion | lit}}"
{{end}}

func {{.GolangName}}URL(
    {{range s.Variables.Entries}}{{.Key | id}} string,{{end}}
) {{qualr "" "ParamString"}} {
    {{if gt s.Variables.Len 0}}
        {{range s.Variables.Entries}}
            {{if .Value.T.Default}}
                if {{.Key | id}} == "" {
                    {{.Key | id}} = "{{.Value.T.Default}}"
                }
            {{end}}
        {{end}}
        paramMap := map[string]string{
            {{range s.Variables.Entries}}{{.Key | lit}}: {{.Value.T.Name | id}},{{end}}
        }
        return {{qualr "" "ParamString"}}{
            Expr: {{.URL | lit}},
            Parameters: paramMap,
        }
    {{else}}
        return {{qualr "" "ParamString"}}{
            Expr: {{.URL | lit}},
        }
    {{end}}
}

{{if .BindingsStruct}}
    {{.BindingsStruct.D}}
    {{range $proto := .BindingsProtocols}}
        {{$bindingsValue := .ProtoBindingsValue $proto}}
        func (c *{{ .BindingStruct.U }}) {{ $proto | title }}() {{$bindingsValue.Type.U}} {
            b := {{$bindingsValue.U}}
            {{if .BindingsPromise}}
                {{$jvals := .BindingsPromise.T.JSONValues.GetOrEmpty $proto}}
                {{range $jval := $jvals.Entries}}
                    {{$jval.Key | lowerCamelize }} := {{$jval.Value | lit}}
                    _ = {{qual "encoding/json.Unmarshal"}}([]byte({{$jval.Key | lowerCamelize }}), &b.{{$jval.Key}})
                {{end}}
            {{end}}
            return b
        }
    {{end}}
{{end}}
