{{if .ProtocolVersion}}
const {{.TypeNamePrefix}}ProtocolVersion = "{{.ProtocolVersion | golit}}"
{{end}}

func {{.TypeNamePrefix}}URL(
    {{range s.VariablesPromises.Entries}}{{.Key | goid}} string,{{end}}
) {{qualrun "ParamString"}} {
    {{if gt s.VariablesPromises.Len 0}}
        {{range s.VariablesPromises.Entries}}
            {{if .Value.T.Default}}
                if {{.Key | goid}} == "" {
                    {{.Key | goid}} = "{{.Value.T.Default}}"
                }
            {{end}}
        {{end}}
        paramMap := map[string]string{
            {{range s.VariablesPromises.Entries}}{{.Key | golit}}: {{.Value.T.Name | goid}},{{end}}
        }
        return {{qualrun "ParamString"}}{
            Expr: {{.URL | golit}},
            Parameters: paramMap,
        }
    {{else}}
        return {{qualrun "ParamString"}}{
            Expr: {{.URL | golit}},
        }
    {{end}}
}

{{if .BindingsType}}
    {{.BindingsType.D}}
    {{range $proto := .BindingsProtocols}}
        {{$bindingsValue := .ProtoBindingsValue $proto}}
        func (c *{{ .BindingStruct.U }}) {{ $proto | capitalize }}() {{$bindingsValue.Type.U}} {
            b := {{$bindingsValue.U}}
            {{if .BindingsPromise}}
                {{$jvals := .BindingsPromise.T.JSONValues.GetOrEmpty $proto}}
                {{range $jval := $jvals.Entries}}
                    {{$jval.Key | toCamelCase }} := {{$jval.Value | golit}}
                    _ = {{qual "encoding/json.Unmarshal"}}([]byte({{$jval.Key | toCamelCase }}), &b.{{$jval.Key}})
                {{end}}
            {{end}}
            return b
        }
    {{end}}
{{end}}
