{{- /*
    .Object == render.Operation;
    .Config == common.ConfigDiagram
    */}}
{{define "diagram/operation"}}
{{- if $.Config.ShowDocumentBorders}}{{goIDLower $.Object.Pointer.Location}}.{{end}}{{ goIDLower $.Object }}: "{{$.Object.IsPublisher | ternary "ðŸ“¤" "ðŸ“¥"}} {{$.Object.Name | toQuotable | ellipsis 25}}" {
    class: operation
}

{{- $securityText := ""}}
{{- with .Object.SecuritySchemes}}
    {{- $securityText = "\\n"}}
    {{- range .}}{{$securityText = print $securityText " ðŸ”’" .SchemeType }}{{end}}
{{- end}}

{{- if $.Config.ShowServers }}
    {{- $channel := $.Object.Channel}}
    {{- range $server := $channel.BoundServers }}
        {{- range $message := $.Object.BoundMessages }}
            {{if $.Config.ShowDocumentBorders}}{{goIDLower $.Object.Pointer.Location}}.{{end}}{{ goIDLower $.Object }} {{$.Object.IsPublisher | ternary "->" "<-"}} {{if $.Config.ShowDocumentBorders}}{{goIDLower $server.Pointer.Location}}.{{end}}{{goIDLower $server}}{{if $.Config.ShowChannels}}.{{goIDLower $channel}}{{end}}: {
                {{- if isVisible $message }}{{with $message.Name}}label: "âœ‰ï¸ {{. | toQuotable | ellipsis 25}}{{$securityText}}"{{end}}{{end}}
            }
        {{- end}}
    {{- end}}
    {{- if and $.Object.OperationReply $.Object.OperationReply.Channel}}
        {{- $channel = $.Object.OperationReply.Channel}}
    {{- end}}
    {{- range $server := $channel.BoundServers }}
        {{- range $message := $.Object.BoundReplyMessages }}
            {{if $.Config.ShowDocumentBorders}}{{goIDLower $.Object.Pointer.Location}}.{{end}}{{ goIDLower $.Object }} {{$.Object.IsReplyPublisher | ternary "->" "<-"}} {{if $.Config.ShowDocumentBorders}}{{goIDLower $server.Pointer.Location}}.{{end}}{{goIDLower $server}}{{if $.Config.ShowChannels}}.{{goIDLower $channel}}{{end}}: {
                {{- if isVisible $message }}{{with $message.Name}}label: "ðŸ“© [Reply] {{. | toQuotable | ellipsis 25}}{{$securityText}}"{{end}}{{end}}
            }
        {{- end}}
    {{- end}}
{{- else}}
    {{- $channel := $.Object.Channel}}
    {{- range $message := $.Object.BoundMessages }}
        {{if $.Config.ShowDocumentBorders}}{{goIDLower $.Object.Pointer.Location}}.{{end}}{{ goIDLower $.Object }} {{$.Object.IsPublisher | ternary "->" "<-"}} {{if $.Config.ShowDocumentBorders}}{{goIDLower $channel.Pointer.Location}}.{{end}}{{goIDLower $channel}}: {
            {{- if isVisible $message }}{{with $message.Name}}label: "âœ‰ï¸ {{. | toQuotable | ellipsis 25}}{{$securityText}}"{{end}}{{end}}
        }
    {{- end}}
    {{- if and $.Object.OperationReply $.Object.OperationReply.Channel}}
        {{- $channel = $.Object.OperationReply.Channel}}
    {{- end}}
    {{- range $message := $.Object.BoundReplyMessages }}
        {{if $.Config.ShowDocumentBorders}}{{goIDLower $.Object.Pointer.Location}}.{{end}}{{ goIDLower $.Object }} {{$.Object.IsReplyPublisher | ternary "->" "<-"}} {{if $.Config.ShowDocumentBorders}}{{goIDLower $channel.Pointer.Location}}.{{end}}{{goIDLower $channel}}: {
            {{- if isVisible $message }}{{with $message.Name}}label: "ðŸ“© [Reply] {{. | toQuotable | ellipsis 25}}{{$securityText}}"{{end}}{{end}}
        }
    {{- end}}
{{- end}}
{{- end}}
