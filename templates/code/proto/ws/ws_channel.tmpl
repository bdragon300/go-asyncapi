{{- /* dot == render.ProtoChannel */}}
{{define "code/proto/ws/channel/publishMethods/block2"}}
    envelope.SetOpCode(byte({{goQual "github.com/gobwas/ws.OpBinary"}}))
{{- end}}

{{define "code/proto/ws/channel/bindings/values"}}
{{- goQualU .Protocol "ChannelBindings"}}{
    {{- with .Bindings.Values.Map.ws}}
        {{with .method }}Method: {{goLit .}},{{end}}
        {{with .query }}Query: {{toJSON . | goLit}},{{end}}
        {{with .headers }}Headers: {{toJSON . | goLit}},{{end}}
    {{- end}}
}
{{- end}}

{{template "code/proto/channel/newFunction" .}}
{{template "code/proto/channel/serverInterface" .}}
{{template "code/proto/channel/openFunction" .}}

type {{. | goIDUpper}}{{.Protocol | goIDUpper}} struct {
    address    {{goQualR "ParamString"}}
    {{if .IsPublisher}}publisher  {{goQualU .Protocol "Publisher"}}{{end}}
    {{if .IsSubscriber}}subscriber {{goQualU .Protocol "Subscriber"}}{{end}}
}

{{template "code/proto/channel/commonMethods" .}}
{{if .IsPublisher}}{{template "code/proto/channel/publishMethods" .}}{{end}}
{{if .IsSubscriber}}{{template "code/proto/channel/subscribeMethods" .}}{{end}}
