{{- /* dot == render.ProtoChannel */}}
{{define "channel/amqp/newFunction/block1"}}
    {{- if and .BindingsType (.BindingsProtocols | has .Protocol)}}
        bindings := {{ .BindingsType | goUsage }}{}.{{.Protocol | goIDUpper}}()
        switch bindings.ChannelType {
        case {{goQualR .Protocol "ChannelTypeQueue"}}:
            res.queue = res.address.String()
        default:
            res.routingKey = res.address.String()
        }
        if bindings.ExchangeConfiguration.Name != nil {
            res.exchange = *bindings.ExchangeConfiguration.Name
        }
        if bindings.QueueConfiguration.Name != "" {
            res.queue = bindings.QueueConfiguration.Name
        }
    {{- end}}
{{- end}}
{{define "channel/amqp/publishMethods/block1"}}
    envelope.SetRoutingKey(c.RoutingKey())
{{- end}}

{{- def .Type}}
{{template "channel/proto/newFunction" .}}

{{template "channel/proto/openFunction" .}}

{{- if ndefined .Type}}
{{ .Type | goDef }}

{{template "channel/proto/commonMethods" .}}

func (c {{ .Type | goUsage }}) Exchange() string {
    return c.exchange
}

func (c {{ .Type | goUsage }}) Queue() string {
    return c.queue
}

func (c {{ .Type | goUsage }}) RoutingKey() string {
    return c.routingKey
}

{{if .IsPublisher}}{{template "channel/proto/publishMethods" .}}{{end}}

{{if .IsSubscriber}}{{template "channel/proto/subscribeMethods" .}}{{end}}

{{template "channel/proto/serverInterface" .}}
{{- end}}
