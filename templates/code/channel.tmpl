{{- /* dot == render.Channel */}}
{{- pin .}}

{{- with .Parameters.Entries }}
    type {{goIDUpper $}}Parameters struct {
    {{- range .}}
        {{goIDUpper .Key}} {{goPkg .Value}}{{goIDUpper .Value}}
    {{- end}}
    }
{{- end }}

func {{. | goIDUpper}}Address({{if .Parameters.Len}}params {{goIDUpper $}}Parameters{{end}}) {{goQualR "ParamString"}} {
{{- if .Parameters.Len}}
    paramMap := map[string]string{
    {{- range .Parameters.Keys}}
        {{goLit .}}: string(params.{{goIDUpper .}}),
    {{- end}}
    }
    return {{goQualR "ParamString"}}{
        Expr: {{ .Address | goLit}},
        Parameters: paramMap,
    }
{{- else}}
    return {{goQualR "ParamString"}}{
        Expr: {{ .Address | goLit}},
    }
{{- end}}
}

{{- if .Bindings }}
    type {{goIDUpper $}}Bindings struct{}

    {{- range $proto := $.Bindings.Protocols}}
        {{with tryTmpl (print "code/proto/" $proto "/channel/bindings/values") ($.ProtoChannel $proto)}}
            func (c {{goIDUpper $}}Bindings) {{ goIDUpper $proto }}() {{goQualU $proto "ChannelBindings"}} {
                return {{.}}
            }
        {{- end}}
    {{- end}}
{{- end}}
